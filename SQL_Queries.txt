*SQL Query for column data types
    CREATE TABLE test(
         "title" TEXT,
         "developer" TEXT,
         "platform" TEXT,
         "release_date" TEXT,
         "critic_score" REAL,
         "number_of_critics" INTEGER,
         "user_score" REAL,
         "number_of_users" INTEGER,
         "player_mode" TEXT,
         "esrb_rating" TEXT,
         "genre" TEXT)

*SQL Query for table import - change path and title 'Test' as needed
    select import('C:\Users\shawn\PycharmProjects\Scrape\Metacritic_Games.csv', 'CSV', 'Test', 'UTF-8',"")

*Experimenting with updates
    Update Raw_Games
    SET esrb_rating = NULL
    WHERE esrb_rating = ""

    UPDATE Raw_Games
    SET player_mode = NULL
    WHERE player_mode = ""

*Find how many duplicates per title
    SELECT title, COUNT(title) as count from raw_games
    GROUP BY title
    ORDER BY count desc

*Find popularity categorized by ESRB rating
    SELECT esrb_rating, COUNT(esrb_rating) as count FROM raw_games
    GROUP BY esrb_rating
    ORDER BY count desc

*Gather distinct titles where the platform score is highest

  *STEP 1 CREATE NEW TABLE SORTED

    CREATE TABLE test(
         "title" TEXT,
         "developer" TEXT,
         "platform" TEXT,
         "release_date" TEXT,
         "critic_score" REAL,
         "number_of_critics" INTEGER,
         "user_score" REAL,
         "number_of_users" INTEGER,
         "player_mode" TEXT,
         "esrb_rating" TEXT,
         "genre" TEXT);
    INSERT INTO test SELECT * FROM raw_games
    ORDER BY user_score DESC, number_of_users DESC /* Multi-level sorting (nice)

  *STEP 2 USE rowid FOR INDEXING THEN DELETE ROWS THAT COME AFTER THE FIRST INSTANCE OF A DUPLICATE YIELDS HIGHEST
  SCORE FOR A TITLE

    DELETE FROM test
    WHERE rowid NOT IN
    (SELECT MIN(rowid) FROM test
    GROUP BY title)

*How to give a score more or less weight? # TODO

*Need to reformat dates for date comparisons - Whoops..  #TODO Give date correct type in order to do BETWEEN? also YYYY-MM-DD?
    SELECT title,
    substr(release_date, 7) ||
    substr(release_date, 1, 2) ||
    substr(release_date, 4, 2) as formatted_date,
    release_date FROM Raw_games

*Number of games per platform - #TODO don't equalize. Can draw correlation after duplicate clean
    SELECT platform, count(platform) AS count FROM test
    GROUP BY platform
    ORDER BY count DESC

*Top Developers
    SELECT developer, count(developer) AS count FROM raw_games
    GROUP BY developer
    ORDER BY count DESC

*Count single player and multiplayer games
    SELECT COUNT(player_mode) FILTER (WHERE player_mode = '1 Player' OR player_mode = 'No Online Multiplayer') AS Single_Player,
    COUNT(player_mode) FILTER (WHERE player_mode != '1 Player' OR player_mode != 'No Online Multiplayer' OR player_mode IS NOT NULL) AS Multiplayer
    FROM test

*Find which games critics and users agree on the most

*Find which games critics and users disagree on the most

*Years ranked by number of games in each year
    SELECT t, count(t) as year
    FROM (SELECT substr(test.release_date, 7) as t FROM test) /* derived table in FROM clause to pull from first */
    GROUP BY t
